var X=(e,t,s)=>{if(!t.has(e))throw TypeError("Cannot "+s)};var r=(e,t,s)=>(X(e,t,"read from private field"),s?s.call(e):t.get(e)),a=(e,t,s)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,s)},o=(e,t,s,i)=>(X(e,t,"write to private field"),i?i.call(e,s):t.set(e,s),s);var d=(e,t,s)=>(X(e,t,"access private method"),s);import{S as St,s as Y,n as Et,i as dt,c as ft,t as xt,f as Qt,d as It,r as pt,e as yt,g,h as wt,j as O}from"./index-BUAdi1HS.js";var b,n,L,p,x,U,y,T,M,j,Q,I,S,D,w,P,k,Z,A,$,B,q,N,tt,_,et,H,st,V,rt,W,Rt,vt,Ft=(vt=class extends St{constructor(t,s){super();a(this,w);a(this,k);a(this,A);a(this,B);a(this,N);a(this,_);a(this,H);a(this,V);a(this,W);a(this,b,void 0);a(this,n,void 0);a(this,L,void 0);a(this,p,void 0);a(this,x,void 0);a(this,U,void 0);a(this,y,void 0);a(this,T,void 0);a(this,M,void 0);a(this,j,void 0);a(this,Q,void 0);a(this,I,void 0);a(this,S,void 0);a(this,D,new Set);this.options=s,o(this,b,t),o(this,y,null),this.bindMethods(),this.setOptions(s)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(r(this,n).addObserver(this),bt(r(this,n),this.options)?d(this,w,P).call(this):this.updateResult(),d(this,N,tt).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return it(r(this,n),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return it(r(this,n),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,d(this,_,et).call(this),d(this,H,st).call(this),r(this,n).removeObserver(this)}setOptions(t,s){const i=this.options,c=r(this,n);if(this.options=r(this,b).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean")throw new Error("Expected enabled to be a boolean");d(this,V,rt).call(this),r(this,n).setOptions(this.options),i._defaulted&&!Y(this.options,i)&&r(this,b).getQueryCache().notify({type:"observerOptionsUpdated",query:r(this,n),observer:this});const u=this.hasListeners();u&&mt(r(this,n),c,this.options,i)&&d(this,w,P).call(this),this.updateResult(s),u&&(r(this,n)!==c||this.options.enabled!==i.enabled||this.options.staleTime!==i.staleTime)&&d(this,k,Z).call(this);const h=d(this,A,$).call(this);u&&(r(this,n)!==c||this.options.enabled!==i.enabled||h!==r(this,S))&&d(this,B,q).call(this,h)}getOptimisticResult(t){const s=r(this,b).getQueryCache().build(r(this,b),t),i=this.createResult(s,t);return Mt(this,i)&&(o(this,p,i),o(this,U,this.options),o(this,x,r(this,n).state)),i}getCurrentResult(){return r(this,p)}trackResult(t,s){const i={};return Object.keys(t).forEach(c=>{Object.defineProperty(i,c,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(c),s==null||s(c),t[c])})}),i}trackProp(t){r(this,D).add(t)}getCurrentQuery(){return r(this,n)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const s=r(this,b).defaultQueryOptions(t),i=r(this,b).getQueryCache().build(r(this,b),s);return i.isFetchingOptimistic=!0,i.fetch().then(()=>this.createResult(i,s))}fetch(t){return d(this,w,P).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),r(this,p)))}createResult(t,s){var lt;const i=r(this,n),c=this.options,u=r(this,p),h=r(this,x),f=r(this,U),F=t!==i?t.state:r(this,L),{state:C}=t;let l={...C},at=!1,v;if(s._optimisticResults){const m=this.hasListeners(),J=!m&&bt(t,s),Ot=m&&mt(t,i,s,c);(J||Ot)&&(l={...l,...It(C.data,t.options)}),s._optimisticResults==="isRestoring"&&(l.fetchStatus="idle")}let{error:ht,errorUpdatedAt:ot,status:E}=l;if(s.select&&l.data!==void 0)if(u&&l.data===(h==null?void 0:h.data)&&s.select===r(this,T))v=r(this,M);else try{o(this,T,s.select),v=s.select(l.data),v=pt(u==null?void 0:u.data,v,s),o(this,M,v),o(this,y,null)}catch(m){o(this,y,m)}else v=l.data;if(s.placeholderData!==void 0&&v===void 0&&E==="pending"){let m;if(u!=null&&u.isPlaceholderData&&s.placeholderData===(f==null?void 0:f.placeholderData))m=u.data;else if(m=typeof s.placeholderData=="function"?s.placeholderData((lt=r(this,j))==null?void 0:lt.state.data,r(this,j)):s.placeholderData,s.select&&m!==void 0)try{m=s.select(m),o(this,y,null)}catch(J){o(this,y,J)}m!==void 0&&(E="success",v=pt(u==null?void 0:u.data,m,s),at=!0)}r(this,y)&&(ht=r(this,y),v=r(this,M),ot=Date.now(),E="error");const z=l.fetchStatus==="fetching",K=E==="pending",G=E==="error",ut=K&&z,ct=v!==void 0;return{status:E,fetchStatus:l.fetchStatus,isPending:K,isSuccess:E==="success",isError:G,isInitialLoading:ut,isLoading:ut,data:v,dataUpdatedAt:l.dataUpdatedAt,error:ht,errorUpdatedAt:ot,failureCount:l.fetchFailureCount,failureReason:l.fetchFailureReason,errorUpdateCount:l.errorUpdateCount,isFetched:l.dataUpdateCount>0||l.errorUpdateCount>0,isFetchedAfterMount:l.dataUpdateCount>F.dataUpdateCount||l.errorUpdateCount>F.errorUpdateCount,isFetching:z,isRefetching:z&&!K,isLoadingError:G&&!ct,isPaused:l.fetchStatus==="paused",isPlaceholderData:at,isRefetchError:G&&ct,isStale:nt(t,s),refetch:this.refetch}}updateResult(t){const s=r(this,p),i=this.createResult(r(this,n),this.options);if(o(this,x,r(this,n).state),o(this,U,this.options),r(this,x).data!==void 0&&o(this,j,r(this,n)),Y(i,s))return;o(this,p,i);const c={},u=()=>{if(!s)return!0;const{notifyOnChangeProps:h}=this.options,f=typeof h=="function"?h():h;if(f==="all"||!f&&!r(this,D).size)return!0;const R=new Set(f??r(this,D));return this.options.throwOnError&&R.add("error"),Object.keys(r(this,p)).some(F=>{const C=F;return r(this,p)[C]!==s[C]&&R.has(C)})};(t==null?void 0:t.listeners)!==!1&&u()&&(c.listeners=!0),d(this,W,Rt).call(this,{...c,...t})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&d(this,N,tt).call(this)}},b=new WeakMap,n=new WeakMap,L=new WeakMap,p=new WeakMap,x=new WeakMap,U=new WeakMap,y=new WeakMap,T=new WeakMap,M=new WeakMap,j=new WeakMap,Q=new WeakMap,I=new WeakMap,S=new WeakMap,D=new WeakMap,w=new WeakSet,P=function(t){d(this,V,rt).call(this);let s=r(this,n).fetch(this.options,t);return t!=null&&t.throwOnError||(s=s.catch(Et)),s},k=new WeakSet,Z=function(){if(d(this,_,et).call(this),dt||r(this,p).isStale||!ft(this.options.staleTime))return;const s=xt(r(this,p).dataUpdatedAt,this.options.staleTime)+1;o(this,Q,setTimeout(()=>{r(this,p).isStale||this.updateResult()},s))},A=new WeakSet,$=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(r(this,n)):this.options.refetchInterval)??!1},B=new WeakSet,q=function(t){d(this,H,st).call(this),o(this,S,t),!(dt||this.options.enabled===!1||!ft(r(this,S))||r(this,S)===0)&&o(this,I,setInterval(()=>{(this.options.refetchIntervalInBackground||Qt.isFocused())&&d(this,w,P).call(this)},r(this,S)))},N=new WeakSet,tt=function(){d(this,k,Z).call(this),d(this,B,q).call(this,d(this,A,$).call(this))},_=new WeakSet,et=function(){r(this,Q)&&(clearTimeout(r(this,Q)),o(this,Q,void 0))},H=new WeakSet,st=function(){r(this,I)&&(clearInterval(r(this,I)),o(this,I,void 0))},V=new WeakSet,rt=function(){const t=r(this,b).getQueryCache().build(r(this,b),this.options);if(t===r(this,n))return;const s=r(this,n);o(this,n,t),o(this,L,t.state),this.hasListeners()&&(s==null||s.removeObserver(this),t.addObserver(this))},W=new WeakSet,Rt=function(t){yt.batch(()=>{t.listeners&&this.listeners.forEach(s=>{s(r(this,p))}),r(this,b).getQueryCache().notify({query:r(this,n),type:"observerResultsUpdated"})})},vt);function Ut(e,t){return t.enabled!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function bt(e,t){return Ut(e,t)||e.state.data!==void 0&&it(e,t,t.refetchOnMount)}function it(e,t,s){if(t.enabled!==!1){const i=typeof s=="function"?s(e):s;return i==="always"||i!==!1&&nt(e,t)}return!1}function mt(e,t,s,i){return(e!==t||i.enabled===!1)&&(!s.suspense||e.state.status!=="error")&&nt(e,s)}function nt(e,t){return t.enabled!==!1&&e.isStaleByTime(t.staleTime)}function Mt(e,t){return!Y(e.getCurrentResult(),t)}var Ct=g.createContext(!1),jt=()=>g.useContext(Ct);Ct.Provider;function Dt(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var Pt=g.createContext(Dt()),Lt=()=>g.useContext(Pt);function Tt(e,t){return typeof e=="function"?e(...t):!!e}var kt=(e,t)=>{(e.suspense||e.throwOnError)&&(t.isReset()||(e.retryOnMount=!1))},At=e=>{g.useEffect(()=>{e.clearReset()},[e])},Bt=({result:e,errorResetBoundary:t,throwOnError:s,query:i})=>e.isError&&!t.isReset()&&!e.isFetching&&i&&Tt(s,[e.error,i]),Nt=e=>{e.suspense&&typeof e.staleTime!="number"&&(e.staleTime=1e3)},_t=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,Ht=(e,t,s)=>t.fetchOptimistic(e).catch(()=>{s.clearReset()});function Vt(e,t,s){const i=wt(),c=jt(),u=Lt(),h=i.defaultQueryOptions(e);h._optimisticResults=c?"isRestoring":"optimistic",Nt(h),kt(h,u),At(u);const[f]=g.useState(()=>new t(i,h)),R=f.getOptimisticResult(h);if(g.useSyncExternalStore(g.useCallback(F=>{const C=c?()=>{}:f.subscribe(yt.batchCalls(F));return f.updateResult(),C},[f,c]),()=>f.getCurrentResult(),()=>f.getCurrentResult()),g.useEffect(()=>{f.setOptions(h,{listeners:!1})},[h,f]),_t(h,R))throw Ht(h,f,u);if(Bt({result:R,errorResetBoundary:u,throwOnError:h.throwOnError,query:i.getQueryCache().get(h.queryHash)}))throw R.error;return h.notifyOnChangeProps?R:f.trackResult(R)}function Gt(e,t){return Vt(e,Ft)}async function Jt(){return(await fetch("https://614c99f03c438c00179faa84.mockapi.io/fruits")).json()}function Xt(e){const[t,s]=g.useState(()=>matchMedia(e).matches);return g.useLayoutEffect(()=>{const i=matchMedia(e);function c(){s(i.matches)}return i.addEventListener("change",c),()=>{i.removeEventListener("change",c)}},[e]),t}function gt(e){e.stopPropagation()}function Yt({author:e}){return O.jsxs(O.Fragment,{children:[O.jsx("div",{className:"absolute top-0 h-full w-full bg-gradient-to-b from-transparent via-transparent to-current text-black text-opacity-50"}),O.jsxs("div",{className:"absolute bottom-1 right-1 px-1 text-xs text-white",children:[O.jsx("span",{children:"Photo by "}),O.jsx("a",{"data-testid":"FruitImageAuthor",href:e.url,target:"_blank",rel:"noreferrer noopener",className:"underline",onClick:gt,children:e.name}),O.jsx("span",{children:" on "}),O.jsx("a",{href:"https://unsplash.com",target:"_blank",rel:"noreferrer noopener",className:"underline",onClick:gt,children:"Unsplash"})]})]})}function Zt({title:e}){return g.useEffect(()=>{document.title=e},[e]),null}export{Zt as H,Yt as I,Gt as a,Jt as g,Xt as u};
